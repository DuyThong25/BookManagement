@model ProductFilterVM
@{
    ViewData["Title"] = "Product Page";
}

<div class="container border border-1 border-black border-opacity-10 box-shadow shadow bg-white p-3 rounded-2">
    <div class="row">
        <div class="col-md-2">
            @* Search Product*@
            @*   <div>
            <label class="form-label">Search Product</label>
            <input class="border border-1 border-black border-opacity-50 my-2 rounded rounded-1 p-1" />
            <span class="text-danger"></span>
            </div> *@
            @*  <hr class="my-4" /> *@
            @* Filter Category*@
            <div class="accordion accordion-flush border-bottom border-1 border-black border-opacity-10 pb-2">
                <div class="accordion-item">
                    <h2 class="accordion-header br" id="flush-headingOne">
                        <button class="accordion-button collapsed p-2" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                            Category
                        </button>
                    </h2>
                    <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body px-2">
                            @foreach (var category in Model.Categories)
                            {
                                <div>
                                    <input type="checkbox" value="@category.CategoryId" name="SelectedCategoryIds" />
                                    <label>@category.Name</label>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            @* Filter Price *@
            <div class="accordion accordion-flush border-bottom border-1 border-black border-opacity-10 pb-2 mt-2">
                <div class="accordion-item">
                    <h2 class="accordion-header br" id="flush-headingTwo">
                        <button class="accordion-button collapsed p-2" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                            Price Range
                        </button>
                    </h2>
                    <div id="flush-collapseTwo" class="accordion-collapse collapse" aria-labelledby="flush-headingTwo" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body px-2">
                            <input type="range" value="0" min="0" max="100" step="50" class="form-range my-1" />
                            <ul class="list-group list-group-horizontal d-flex justify-content-between">
                                <li class="list-group-item p-0 border-0 fw-bold text-secondary">All</li>
                                <li class="list-group-item p-0 border-0 ">50$</li>
                                <li class="list-group-item p-0 border-0 ">100$</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-10">
            <div class="row">
                <div class="col-md-6">
                    <input class="w-100 border border-1 border-black border-opacity-50 my-2 rounded rounded-1 p-1" />
                </div>
            </div>
            @* Danh sách loại sản phẩm đang được chọn*@
            @if (Model.SelectedCategoryIds != null)
            {
                @foreach (var category in Model.Categories)
                {
                    @if(Model.SelectedCategoryIds.Contains(category.CategoryId))
                    {
                        <div class="col-1 mt-2">
                            <button type="button" class="btn btn-primary position-relative">
                                @category.Name <a class="position-absolute top-0 start-100 translate-middle badge border border-light rounded-circle bg-danger p-1"><i class="bi bi-x"></i></a>
                            </button>
                        </div>
                    }
                }
            }
            @* Danh sách sản phẩm *@
            <div class="row">
                @foreach (var obj in Model.Products)
                {

                    <div class="col-6 col-lg-3 d-flex justify-content-around my-5">
                        <div class="card border-0 border-5 border-top shadow rounded-2 text-center p-2" style="width:260px">
                            <div class="h-100">
                                @if (obj.ProductImages != null && obj.ProductImages.Count > 0)
                                {
                                    <img class="card-img-top rounded" src="@obj.ProductImages.FirstOrDefault().ImageUrl" alt="Card Book">
                                }
                                else
                                {
                                    <img class="card-img-top rounded" src="~/images//product/no_image.jpg" alt="Card Book">
                                }
                            </div>
                            <div class="card-body">
                                <div style="height:70px;" class="d-flex flex-column justify-content-center mh-100">
                                    <p class="card-title  h4 text-black text-uppercase text-opacity-75">
                                        @obj.Title
                                    </p>
                                </div>
                                <div>
                                    <p class="card-title text-warning">by <b>@obj.Author</b></p>
                                </div>
                                <div>
                                    <p class="text-black text-opacity-50 m-0">List price: <span class="text-decoration-line-through ">@obj.ListPrice.ToString("c")</span></p>
                                    <p>As low as <b>@obj.Price100.ToString("c")</b></p>
                                </div>
                                <div>
                                    <a asp-area="Customer" asp-controller="Home" asp-action="Detail" asp-route-productId="@obj.ProductId" asp- class="btn btn-primary bg-gradient border-0 form-control">Detail</a>
                                </div>

                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        var elementItemListGroup = document.getElementsByClassName("list-group-item");
        var elementRange = document.querySelector("input[type='range']")

        elementRange.addEventListener("change", (e) => {
            // Xoa bo class active cu
            Array.from(elementItemListGroup).forEach((e) => {
                e.classList.remove("fw-bold", "text-secondary")
            });

            if (e.target.value == 0) {
                elementItemListGroup[0].classList.add("fw-bold", "text-secondary")
            } else if (e.target.value == 50) {
                elementItemListGroup[1].classList.add("fw-bold", "text-secondary")
            } else {
                elementItemListGroup[2].classList.add("fw-bold", "text-secondary")
            }
        })
    </script>
}